<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Cryptographically Verifiable Actor Chain for OAuth 2.0 Token Exchange</title>
<meta content="A Prasad" name="author">
<meta content="Ram Krishnan" name="author">
<meta content="Diego R. Lopez" name="author">
<meta content="Srinivasa Addepalli" name="author">
<meta content='
       This document defines an extension to OAuth 2.0 Token Exchange [[RFC8693]] that addresses the problem of  Delegation Auditability Gaps  in multi-hop service environments. Current standards treat prior actors in a delegation chain as "informational only," providing no cryptographic proof of the actual delegation path. This document proposes a new  actor_chain  claim — a  Cryptographically Verifiable Actor Chain  — that replaces the informational-only nested  act  claim with a tamper-evident, ordered record of all actors. This solution enables high-assurance data-plane policy enforcement and forensic auditability, particularly for dynamic AI agent-to-agent workloads—where susceptibility to  prompt injection attacks  can lead to unauthorized delegation paths—the security posture of the entire delegation chain is critical for authorization decisions. 
    ' name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="actor chain" name="keyword">
<meta content="spice" name="keyword">
<meta content="rfc8693" name="keyword">
<meta content="token exchange" name="keyword">
<meta content="workload identity" name="keyword">
<meta content="delegation" name="keyword">
<meta content="AI agents" name="keyword">
<meta content="draft-mw-spice-actor-chain-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.10.12
    ConfigArgParse 1.7.1
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 26.2.16
    PyYAML 5.4.1
    requests 2.32.5
    wcwidth 0.6.0
-->
<link href="draft-mw-spice-actor-chain-00.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://static.ietf.org/fonts/noto-sans/import.css'); /* Sans-serif */
@import url('https://static.ietf.org/fonts/noto-serif/import.css'); /* Serif (print) */
@import url('https://static.ietf.org/fonts/roboto-mono/import.css'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SPICE-ACTOR-CHAIN</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Prasad, et al.</td>
<td class="center">Expires 27 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">SPICE</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mw-spice-actor-chain-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-23" class="published">23 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-27">27 August 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Prasad</div>
<div class="org">Oracle</div>
</div>
<div class="author">
      <div class="author-name">R. Krishnan</div>
<div class="org">JPMorgan Chase &amp; Co</div>
</div>
<div class="author">
      <div class="author-name">D. Lopez</div>
<div class="org">Telefonica</div>
</div>
<div class="author">
      <div class="author-name">S. Addepalli</div>
<div class="org">Aryaka</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Cryptographically Verifiable Actor Chain for OAuth 2.0 Token Exchange</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines an extension to OAuth 2.0 Token Exchange [[RFC8693]] that addresses the problem of <strong>Delegation Auditability Gaps</strong> in multi-hop service environments. Current standards treat prior actors in a delegation chain as "informational only," providing no cryptographic proof of the actual delegation path. This document proposes a new <code>actor_chain</code> claim — a <strong>Cryptographically Verifiable Actor Chain</strong> — that replaces the informational-only nested <code>act</code> claim with a tamper-evident, ordered record of all actors. This solution enables high-assurance data-plane policy enforcement and forensic auditability, particularly for dynamic AI agent-to-agent workloads—where susceptibility to <strong>prompt injection attacks</strong> can lead to unauthorized delegation paths—the security posture of the entire delegation chain is critical for authorization decisions.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-the-problem-rfc-8693-actor-" class="internal xref">The Problem: RFC 8693 Actor Limitations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-single-actor-semantics" class="internal xref">Single-Actor Semantics</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-ai-agent-delegation-chains" class="internal xref">AI Agent Delegation Chains</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-structural-limitations-of-n" class="internal xref">Structural Limitations of Nested <code>act</code></a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-selective-disclosure-sd-jwt" class="internal xref">Selective Disclosure (SD-JWT)</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-the-solution-the-cryptograp" class="internal xref">The Solution: The Cryptographically Verifiable <code>actor_chain</code> Claim</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-claim-definition" class="internal xref">Claim Definition</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-example-tokens" class="internal xref">Example Tokens</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-as-attested-mode" class="internal xref">AS-Attested Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-self-attested-mode" class="internal xref">Self-Attested Mode</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-token-exchange-flow" class="internal xref">Token Exchange Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-disclosure-propagation-in-s" class="internal xref">Disclosure Propagation in SD-JWT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-when-chain-signatures-are-p" class="internal xref">When Chain Signatures Are Produced</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-data-plane-policy-enforceme" class="internal xref">Data-Plane Policy Enforcement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-policy-examples" class="internal xref">Policy Examples</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="auto internal xref">4.5.2</a>.  <a href="#name-integration-with-data-plane" class="internal xref">Integration with Data-Plane Proxies</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-chain-integrity-verificatio" class="internal xref">Chain Integrity Verification</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-relation-to-other-ietf-work" class="internal xref">Relation to Other IETF Work</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-east-west-vs-north-south-se" class="internal xref">East-West vs. North-South Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-backward-compatibility-with" class="internal xref">Backward Compatibility with RFC 8693</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-token-signature-vs-per-entr" class="internal xref">Token Signature vs. Per-Entry Chain Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-chain-integrity" class="internal xref">Chain Integrity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-replay-protection" class="internal xref">Replay Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-chain-depth-limits" class="internal xref">Chain Depth Limits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-key-management" class="internal xref">Key Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-privacy-of-prior-actors" class="internal xref">Privacy of Prior Actors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.1">
                    <p id="section-toc.1-1.7.2.6.2.1.1"><a href="#section-7.6.1" class="auto internal xref">7.6.1</a>.  <a href="#name-pseudonymous-identifiers" class="internal xref">Pseudonymous Identifiers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.2">
                    <p id="section-toc.1-1.7.2.6.2.2.1"><a href="#section-7.6.2" class="auto internal xref">7.6.2</a>.  <a href="#name-selective-disclosure-sd-jwt-2" class="internal xref">Selective Disclosure (SD-JWT)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.3">
                    <p id="section-toc.1-1.7.2.6.2.3.1"><a href="#section-7.6.3" class="auto internal xref">7.6.3</a>.  <a href="#name-identity-bridging-for-anony" class="internal xref">Identity Bridging for Anonymity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.4">
                    <p id="section-toc.1-1.7.2.6.2.4.1"><a href="#section-7.6.4" class="auto internal xref">7.6.4</a>.  <a href="#name-targeted-selective-disclosu" class="internal xref">Targeted Selective Disclosure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.5">
                    <p id="section-toc.1-1.7.2.6.2.5.1"><a href="#section-7.6.5" class="auto internal xref">7.6.5</a>.  <a href="#name-encryption-jwe" class="internal xref">Encryption (JWE)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-confused-deputy-mitigation" class="internal xref">Confused Deputy Mitigation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-json-web-token-claims-regis" class="internal xref">JSON Web Token Claims Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-cbor-web-token-claims-regis" class="internal xref">CBOR Web Token Claims Registration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines an extension to OAuth 2.0 Token Exchange [[RFC8693]] to support high-assurance <strong>East-West</strong> identity delegation through cryptographically verifiable actor chains.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In modern multi-service and AI-agent environments, a workload often delegates its authority to another agent, which may in turn delegate to others. While [[RFC8693]] provides the <code>act</code> (actor) claim to represent delegation, it explicitly restricts prior actors in a nested chain to be "informational only," excluding them from access control considerations. This creates a significant <strong>Delegation Auditability Gap</strong>: Resource Servers cannot verify the full path of authority, and attackers can potentially hide lateral movement or <strong>prompt injection-induced hijacking</strong> within unverified informational claims.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">By providing a standardized <strong>Cryptographically Verifiable Actor Chain</strong>, this extension replaces the informal nested <code>act</code> structure with a policy-enforceable, ordered, and tamper-evident record of all participants. This establishes an <strong>"East-West"</strong> axis of accountability, ensuring that any service in a global delegation chain can be verified for identity, integrity, and (optionally) physical residency.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This solution addresses several critical gaps in [[RFC8693]]:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-1-5">
<li id="section-1-5.1">
          <strong>Cryptographic Audit Trail</strong>: Proves that each prior actor actually participated in the delegation chain and that the sequence has not been tampered with.<a href="#section-1-5.1" class="pilcrow">¶</a>
</li>
        <li id="section-1-5.2">
          <strong>Data-Plane Policy Enforcement</strong>: Enables Resource Servers to write fine-grained authorization policies based on any actor in the path (e.g., "originating actor must be X").<a href="#section-1-5.2" class="pilcrow">¶</a>
</li>
        <li id="section-1-5.3">
          <strong>Dynamic AI Agent Topologies</strong>: Provides a scalable architecture for the unpredictable and deep delegation chains common in autonomous agent networks.<a href="#section-1-5.3" class="pilcrow">¶</a>
</li>
        <li id="section-1-5.4">
          <strong>Data-Plane Efficiency</strong>: Uses a flat, ordered array structure optimized for high-throughput parsing and indexing in cloud-native proxies (e.g., Envoy).<a href="#section-1-5.4" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-1-6">This extension is designed to be backward-compatible and format-agnostic, supporting both JSON/JWS (JWT [[RFC7519]]) and CBOR/COSE (CWT [[RFC8392]]) representations.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 [[RFC2119]] [[RFC8174]] when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document leverages the terminology defined in OAuth 2.0 Token Exchange [[RFC8693]], the SPICE Architecture [[!I-D.ietf-spice-arch]], and the RATS Architecture [[RFC9334]].<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Actor Chain:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">A Cryptographically Verifiable Actor Chain — an ordered sequence of Actor Chain Entries representing the complete delegation path from the originating actor to the current actor. The chain is integrity-protected either by the AS's JWT signature (AS-Attested Mode) or by per-actor cryptographic signatures (Self-Attested Mode).<a href="#section-2-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Actor Chain Entry:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">A JSON object or CBOR map identifying a single actor in the delegation chain, including its identity claims and a cryptographic signature binding it to the chain state at the point of its participation.<a href="#section-2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Chain Digest:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">A cumulative cryptographic hash computed over the delegation history. For any entry at index <code>N</code>, the <code>chain_digest</code> is computed over the concatenation of the current entry's identity claims and the <code>chain_digest</code> of the preceding entry (at index <code>N-1</code>). For the entry at index 0, the digest is computed over that entry's identity claims alone. Each actor produces a <code>per-actor signature</code> over its <code>chain_digest</code>, cryptographically anchoring itself to the entire preceding history.<a href="#section-2-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">Chain Depth:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">The total number of Actor Chain Entries in an actor chain. Used by policy engines to enforce maximum delegation depth.<a href="#section-2-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">Proof of Residency (PoR):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.10">A cryptographic proof (as defined in [[!I-D.draft-mw-spice-transitive-attestation]]) binding a workload to a specific, verified local environment. When present in an Actor Chain Entry, it provides hardware-rooted assurance of the actor's execution context.<a href="#section-2-3.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="the-problem-rfc-8693-actor-limitations">
<section id="section-3">
      <h2 id="name-the-problem-rfc-8693-actor-">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-the-problem-rfc-8693-actor-" class="section-name selfRef">The Problem: RFC 8693 Actor Limitations</a>
      </h2>
<div id="single-actor-semantics">
<section id="section-3.1">
        <h3 id="name-single-actor-semantics">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-single-actor-semantics" class="section-name selfRef">Single-Actor Semantics</a>
        </h3>
<p id="section-3.1-1">[[RFC8693]] Section 4.1 defines the <code>act</code> claim as a JSON object identifying <strong>the</strong> current actor. While nesting is permitted to represent prior actors, the specification explicitly limits their utility. Only the outermost <code>act</code> claim—representing the current actor—is relevant for access control. All prior actors exist solely for informational purposes.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">This design was appropriate for traditional web service delegation where chains are short (typically one or two hops) and the identity of the immediate caller is sufficient for authorization. It is insufficient for the emerging class of workloads described below.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ai-agent-delegation-chains">
<section id="section-3.2">
        <h3 id="name-ai-agent-delegation-chains">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-ai-agent-delegation-chains" class="section-name selfRef">AI Agent Delegation Chains</a>
        </h3>
<p id="section-3.2-1">Modern AI systems increasingly operate as networks of specialized agents. A typical interaction may involve:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-2">
<pre>User -&gt; Orchestrator Agent -&gt; Planning Agent -&gt; Tool Agent -&gt; Data API
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2-3">At each hop, the agent performs a token exchange ([[RFC8693]]) to obtain credentials appropriate for calling the next service. Under current [[RFC8693]] semantics, by the time the request reaches the Data API, only the Tool Agent is identified as the actor. The Orchestrator Agent and Planning Agent—which may have been manipulated via <strong>prompt injection</strong> into delegating authority they should not have—are invisible to policy enforcement.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">This creates several concrete risks:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2-5.1">
            <strong>Lateral Movement</strong>: A compromised agent deep in the chain can impersonate the authority of the originating actor without any cryptographic evidence of the actual delegation path.<a href="#section-3.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-5.2">
            <strong>Policy Bypass</strong>: Fine-grained policies like "only allow data access when the orchestrator is a known, trusted entity" cannot be expressed because the orchestrator's identity is not available for policy evaluation at the data plane.<a href="#section-3.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-5.3">
            <strong>Audit Gaps</strong>: Post-incident forensic analysis cannot reliably reconstruct the delegation path because the nested <code>act</code> claims are self-reported and unsigned.<a href="#section-3.2-5.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="structural-limitations-of-nested-act">
<section id="section-3.3">
        <h3 id="name-structural-limitations-of-n">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-structural-limitations-of-n" class="section-name selfRef">Structural Limitations of Nested <code>act</code></a>
        </h3>
<p id="section-3.3-1">Beyond the semantic restriction, the nested object structure of <code>act</code> in [[RFC8693]] has practical limitations:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-3.3-2">
<li id="section-3.3-2.1">
            <strong>Parsing Complexity</strong>: Each prior actor requires traversing one additional level of JSON nesting. In high-throughput data-plane proxies (e.g., Envoy, Istio sidecars), deep nesting imposes parsing overhead.<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.2">
            <strong>Indexing</strong>: It is not possible to efficiently query "the actor at position N" without recursively unwinding the nested structure.<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.3">
            <strong>Size Predictability</strong>: The depth of nesting is unbounded, making it difficult to predict token sizes and allocate parsing buffers.<a href="#section-3.3-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.4">
            <strong>No Integrity</strong>: Each nested <code>act</code> is a plain JSON object with no signature or hash binding. Any intermediary could insert, remove, or reorder prior actors without detection.<a href="#section-3.3-2.4" class="pilcrow">¶</a>
</li>
        </ol>
<div id="selective-disclosure-sd-jwt">
<section id="section-3.3.1">
          <h4 id="name-selective-disclosure-sd-jwt">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-selective-disclosure-sd-jwt" class="section-name selfRef">Selective Disclosure (SD-JWT)</a>
        </h4>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="the-solution-the-cryptographically-verifiable-actor-chain-claim">
<section id="section-4">
      <h2 id="name-the-solution-the-cryptograp">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-the-solution-the-cryptograp" class="section-name selfRef">The Solution: The Cryptographically Verifiable <code>actor_chain</code> Claim</a>
      </h2>
<div id="overview">
<section id="section-4.1">
        <h3 id="name-overview">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-4.1-1">This document defines a new claim, <code>actor_chain</code>, that provides a Cryptographically Verifiable Actor Chain. When used in a JWT, its value is a JSON array of Actor Chain Entries. When used in a CWT, its value is a CBOR array of Actor Chain Entries. The array is ordered chronologically: index 0 represents the originating actor, and the last index represents the current actor.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The <code>actor_chain</code> claim supports two operational modes:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-3">
<li id="section-4.1-3.1">
            <p id="section-4.1-3.1.1"><strong>AS-Attested Mode</strong>: The Authorization Server (AS) validates each actor at token exchange time and constructs the <code>actor_chain</code>. The AS's signature over the entire token (JWS or COSE) provides integrity protection for the chain. Per-actor <code>chain_sig</code> fields are omitted.<a href="#section-4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-3.2">
            <p id="section-4.1-3.2.1"><strong>Self-Attested Mode</strong>: Each Actor Chain Entry additionally includes a <code>chain_sig</code> field: a cryptographic signature (compact JWS [[RFC7515]] or COSE_Sign1 [[RFC9052]]) computed by that actor over a Chain Digest of all preceding entries. This creates a hash-chain structure providing tamper evidence and non-repudiation independent of the AS.<a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="claim-definition">
<section id="section-4.2">
        <h3 id="name-claim-definition">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-claim-definition" class="section-name selfRef">Claim Definition</a>
        </h3>
<p id="section-4.2-1">The <code>actor_chain</code> claim is a JSON array. Each element of the array is a JSON object (an Actor Chain Entry) with the following members. To support diverse privacy requirements, Selective Disclosure (SD-JWT) is configurable at two levels of granularity:
- <strong>Per-Actor</strong>: An Authorization Server MAY choose to hide entire Actor Chain Entries or only specific actors in the chain.
- <strong>Per-Field</strong>: Within a single Actor Chain Entry, a subset of members (e.g., <code>sub</code>) MAY be hidden using an <code>_sd</code> claim while others (e.g., <code>iat</code> or <code>por</code>) remain in cleartext. These fields typically correspond to the identity claims present in the <strong>Actor Token</strong> or client credentials used during the token exchange flow.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.2-2">
          <dt id="section-4.2-2.1">sub:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.2">REQUIRED (or selectively disclosed). A string identifying the actor, as defined in [[RFC7519]] Section 4.1.2.<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-2.3">iss:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.4">REQUIRED (or selectively disclosed). A string identifying the issuer of the actor's identity, as defined in [[RFC7519]] Section 4.1.1.<a href="#section-4.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-2.5">iat:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.6">REQUIRED (or selectively disclosed). The time at which this actor was appended to the chain, represented as a NumericDate as defined in [[RFC7519]] Section 4.1.6.<a href="#section-4.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-2.7">por:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.8">OPTIONAL. A JSON object containing a Proof of Residency binding this actor to a verified execution environment. The structure of this object is defined in [[!I-D.draft-mw-spice-transitive-attestation]].<a href="#section-4.2-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-2.9">chain_digest:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.10">OPTIONAL. A Base64url-encoded cumulative cryptographic hash (SHA-256). For any entry at index <code>N</code>, the hash is computed over the canonical serialization of the union of the current entry's identity claims (e.g., <code>sub</code>, <code>iss</code>, <code>iat</code>, <code>_sd</code> hashes) and the <code>chain_digest</code> of the preceding entry (index <code>N-1</code>). For the entry at index 0, the hash is computed over its identity claims alone. This recursive structure ensures that a <code>chain_sig</code> at any point in the chain provides proof of participation for all prior actors. REQUIRED in Self-Attested Mode. MUST be omitted in AS-Attested Mode.<a href="#section-4.2-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<blockquote id="section-4.2-3">
          <p id="section-4.2-3.1">[!IMPORTANT]
When Selective Disclosure is used, the SD-JWT <strong>Disclosure strings</strong> (the cleartext salts/values) MUST NOT be included in the canonical serialization used for hashing. The <code>chain_digest</code> is computed exclusively over the Actor Chain Entry object, which contains the stable <code>_sd</code> hashes. This ensures the signature remains valid regardless of which disclosures are subsequently provided to different recipients.<a href="#section-4.2-3.1" class="pilcrow">¶</a></p>
</blockquote>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.2-4">
          <dt id="section-4.2-4.1">chain_sig:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.2">OPTIONAL. A compact JWS [[RFC7515]] signature produced by this actor's private key over the <code>chain_digest</code> value. The JWS header MUST include the <code>jwk</code> or <code>kid</code> member to identify the signing key. REQUIRED in Self-Attested Mode. MUST be omitted in AS-Attested Mode.<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-4.3">chain_mode:</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-4.4">OPTIONAL. A top-level string claim (sibling to <code>actor_chain</code>) indicating the operational mode. Values are <code>as_attested</code> or <code>self_attested</code>. If omitted, the mode is inferred from the presence or absence of <code>chain_sig</code> fields in the Actor Chain Entries.<a href="#section-4.2-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="example-tokens">
<section id="section-4.3">
        <h3 id="name-example-tokens">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-example-tokens" class="section-name selfRef">Example Tokens</a>
        </h3>
<div id="as-attested-mode">
<section id="section-4.3.1">
          <h4 id="name-as-attested-mode">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-as-attested-mode" class="section-name selfRef">AS-Attested Mode</a>
          </h4>
<p id="section-4.3.1-1">In this mode, the AS constructs the <code>actor_chain</code> array and the JWT's own signature provides integrity. No per-entry <code>chain_sig</code> or <code>chain_digest</code> fields are present. This is the simplest deployment model.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-4.3.1-2">
<pre>{
  "aud": "https://data-api.example.com",
  "iss": "https://auth.example.com",
  "exp": 1700000100,
  "nbf": 1700000000,
  "sub": "user@example.com",
  "actor_chain": [
    {
      "sub": "https://orchestrator.example.com",
      "iss": "https://auth.example.com",
      "iat": 1700000010,
      "por": {
        "wia_kid": "spiffe://example.com/wia/node-1",
        "env_hash": "sha256:abc123..."
      }
    },
    {
      "sub": "https://planner.example.com",
      "iss": "https://auth.example.com",
      "iat": 1700000030
    },
    {
      "sub": "https://tool-agent.example.com",
      "iss": "https://auth.example.com",
      "iat": 1700000050,
      "por": {
        "wia_kid": "spiffe://example.com/wia/node-3",
        "env_hash": "sha256:ghi789..."
      }
    }
  ]
}
</pre><a href="#section-4.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-3">The integrity of the chain rests on the AS's JWT signature. The Relying Party trusts the AS to have correctly validated each actor at the time of each token exchange.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="self-attested-mode">
<section id="section-4.3.2">
          <h4 id="name-self-attested-mode">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-self-attested-mode" class="section-name selfRef">Self-Attested Mode</a>
          </h4>
<p id="section-4.3.2-1">In this mode, each Actor Chain Entry additionally carries a <code>chain_digest</code> and <code>chain_sig</code>, forming a hash chain with per-actor non-repudiation. This mode is appropriate for federated deployments, multi-AS environments, or when Relying Parties require cryptographic proof of each actor's participation independent of any single AS.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-4.3.2-2">
<pre>{
  "aud": "https://data-api.example.com",
  "iss": "https://auth.example.com",
  "exp": 1700000100,
  "nbf": 1700000000,
  "sub": "user@example.com",
  "actor_chain": [
    {
      "sub": "https://orchestrator.example.com",
      "iss": "https://auth.example.com",
      "iat": 1700000010,
      "por": {
        "wia_kid": "spiffe://example.com/wia/node-1",
        "env_hash": "sha256:abc123..."
      },
      "chain_digest": "sha256:mno345...",
      "chain_sig": "eyJhbGciOiJFUzI1NiIsImt..."
    },
    {
      "sub": "https://planner.example.com",
      "iss": "https://auth.example.com",
      "iat": 1700000030,
      "chain_digest": "sha256:def456...",
      "chain_sig": "eyJhbGciOiJFUzI1NiIsImt..."
    },
    {
      "sub": "https://tool-agent.example.com",
      "iss": "https://auth.example.com",
      "iat": 1700000050,
      "por": {
        "wia_kid": "spiffe://example.com/wia/node-3",
        "env_hash": "sha256:ghi789..."
      },
      "chain_digest": "sha256:jkl012...",
      "chain_sig": "eyJhbGciOiJFUzI1NiIsImt..."
    }
  ]
}
</pre><a href="#section-4.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-3">In the Self-Attested example:<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.3.2-4.1">
              <strong>Index 0</strong> (Orchestrator): The originating actor. Its <code>chain_digest</code> is <code>SHA-256(canonical_json({sub, iss, iat}))</code> — a self-hash of its own identity claims. Its <code>chain_sig</code> is computed over this digest. It includes a PoR binding it to <code>node-1</code>.<a href="#section-4.3.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.3.2-4.2">
              <strong>Index 1</strong> (Planning Agent): Its <code>chain_digest</code> is <code>SHA-256(canonical_json(actor_chain[0]))</code>. Its <code>chain_sig</code> is produced by the Planning Agent's key over this digest. No PoR is present (the agent may be running in a non-TEE environment).<a href="#section-4.3.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.3.2-4.3">
              <strong>Index 2</strong> (Tool Agent): Its <code>chain_digest</code> is <code>SHA-256(canonical_json(actor_chain[0..1]))</code>. Its <code>chain_sig</code> is produced by the Tool Agent's key over this digest. It includes a PoR for <code>node-3</code>.<a href="#section-4.3.2-4.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="token-exchange-flow">
<section id="section-4.4">
        <h3 id="name-token-exchange-flow">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-token-exchange-flow" class="section-name selfRef">Token Exchange Flow</a>
        </h3>
<p id="section-4.4-1">When an actor (Service B) receives a token containing an <code>actor_chain</code> and needs to call a downstream service (Service C), the following token exchange flow occurs:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.4-2">
<li id="section-4.4-2.1">
            <strong>Service B</strong> sends a token exchange request to the Authorization Server (AS) per [[RFC8693]] Section 2.1.<a href="#section-4.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.2">The <code>subject_token</code> contains the existing <code>actor_chain</code>.<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.3">The <code>actor_token</code> identifies Service B.<a href="#section-4.4-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.4">
            <p id="section-4.4-2.4.1">The AS validates the existing <code>actor_chain</code>:<a href="#section-4.4-2.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.4-2.4.2.1">In Self-Attested Mode: verifies each <code>chain_sig</code> against the corresponding actor's public key and each <code>chain_digest</code> against the hash of preceding entries.<a href="#section-4.4-2.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.4-2.4.2.2">In AS-Attested Mode: verifies the JWT signature and validates the actor identities through its own policy (e.g., client registration, mTLS certificate).<a href="#section-4.4-2.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.4-2.4.2.3">In both modes: enforces any <code>max_chain_depth</code> policy.<a href="#section-4.4-2.4.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-4.4-2.5">
            <p id="section-4.4-2.5.1">The AS constructs a new <code>actor_chain</code> for the issued token by:<a href="#section-4.4-2.5.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.4-2.5.2.1">Copying all existing Actor Chain Entries from the <code>subject_token</code>.<a href="#section-4.4-2.5.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.4-2.5.2.2">Appending a new Actor Chain Entry for Service B.<a href="#section-4.4-2.5.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.4-2.5.2.3">In Self-Attested Mode: the new entry's <code>chain_digest</code> is computed over all preceding entries, and its <code>chain_sig</code> is produced by Service B's key (provided via the <code>actor_token</code> or client credentials).<a href="#section-4.4-2.5.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.4-2.5.2.4">In AS-Attested Mode: the new entry contains only the identity claims (<code>sub</code>, <code>iss</code>, <code>iat</code>) and optional <code>por</code>.<a href="#section-4.4-2.5.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-4.4-2.6">The AS issues a new token with the extended <code>actor_chain</code>.<a href="#section-4.4-2.6" class="pilcrow">¶</a>
</li>
        </ol>
<div id="disclosure-propagation-in-sd-jwt">
<section id="section-4.4.1">
          <h4 id="name-disclosure-propagation-in-s">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-disclosure-propagation-in-s" class="section-name selfRef">Disclosure Propagation in SD-JWT</a>
          </h4>
<p id="section-4.4.1-1">When Selective Disclosure (SD-JWT) [[!I-D.ietf-oauth-selective-disclosure-jwt]] is used for any Actor Chain Entry, the Authorization Server (AS) acts as the Discloser during token exchange. The propagation of the underlying cleartext identities is managed as follows:<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.4.1-2">
<li id="section-4.4.1-2.1">
              <strong>Disclosure Inclusion</strong>: When the AS issues a token for a downstream recipient (Service B), it determines based on policy which hidden identifiers in the <code>actor_chain</code> should be visible to that recipient. For each visible actor, the AS appends the corresponding SD-JWT Disclosure string (containing the salt and cleartext value) to the issued token.<a href="#section-4.4.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.1-2.2">
              <strong>Hop-by-Hop Visibility</strong>: In a chain <code>a -&gt; b -&gt; c -&gt; d -&gt; e</code>, if <code>a</code> is to be visible to <code>b</code>, <code>c</code>, and <code>d</code>, the AS includes <code>a</code>'s disclosure string in the tokens issued to <code>b</code>, <code>c</code>, and <code>d</code> during their respective token exchanges.<a href="#section-4.4.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.1-2.3">
              <strong>Selective Redaction</strong>: When the final exchange occurs for recipient <code>e</code> (the end of the trust zone), the AS simply omits the disclosure string for <code>a</code> from the issued token.<a href="#section-4.4.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.1-2.4">
              <strong>Validation</strong>: Each recipient in the chain can independently verify the hash of any disclosed claim against the <code>_sd</code> array in the Actor Chain Entry. If a disclosure is missing, the recipient sees only the hash, but can still verify the entry's geographic and residency properties through other claims.<a href="#section-4.4.1-2.4" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.4.1-3">This mechanism ensures that the "key" to unlock a hidden identity is passed only to authorized actors in the chain, while the underlying cryptographically signed JWT structure remains identical for all recipients.<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="when-chain-signatures-are-produced">
<section id="section-4.4.2">
          <h4 id="name-when-chain-signatures-are-p">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-when-chain-signatures-are-p" class="section-name selfRef">When Chain Signatures Are Produced</a>
          </h4>
<p id="section-4.4.2-1">In Self-Attested Mode, a critical distinction is that each actor's <code>chain_sig</code> is produced <strong>during the token exchange request</strong>, before the final issued token exists. Consider a scenario where Service A calls Service B, and Service B later needs to call Service C:<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.4.2-2">
<li id="section-4.4.2-2.1">Service A calls Service B, presenting a token containing <code>actor_chain</code> with chain <code>[A]</code>.<a href="#section-4.4.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.2-2.2">Service B receives the token and performs its work.<a href="#section-4.4.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.2-2.3">
              <p id="section-4.4.2-2.3.1"><strong>When Service B needs to call downstream Service C</strong>, it initiates a token exchange with the AS. At this point — not before — Service B:<a href="#section-4.4.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.4.2-2.3.2.1">Computes <code>chain_digest</code> over the existing chain entries from the received token.<a href="#section-4.4.2-2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-4.4.2-2.3.2.2">Signs this <code>chain_digest</code> with its own key, producing <code>chain_sig</code>.<a href="#section-4.4.2-2.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-4.4.2-2.3.2.3">Submits both values to the AS as part of the token exchange request, alongside the <code>subject_token</code> (containing chain <code>[A]</code>) and its own <code>actor_token</code>.<a href="#section-4.4.2-2.3.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-4.4.2-2.4">The AS validates the existing chain, then assembles the new <code>actor_chain</code> (prior entries + Service B's signed entry) into the issued JWT.<a href="#section-4.4.2-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.2-2.5">The AS signs the <strong>entire JWT</strong> (including the <code>actor_chain</code>) with the AS's own key and returns the token to Service B.<a href="#section-4.4.2-2.5" class="pilcrow">¶</a>
</li>
            <li id="section-4.4.2-2.6">Service B uses this new token (containing chain <code>[A, B]</code>) to call Service C.<a href="#section-4.4.2-2.6" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.4.2-3">Consequently, each <code>chain_sig</code> covers only the <strong>actor chain state</strong> at that actor's point of participation — not the enclosing JWT's other claims such as <code>aud</code>, <code>exp</code>, or <code>sub</code>. This is by design: the actor chain and the token are concerns of different parties. The actor signs the chain to prove its participation; the AS signs the token to assert the token's validity. This separation allows the AS to set audience, expiry, and other claims independently without invalidating any actor's chain signature.<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.2-4">
<pre>  Svc A        Auth Server        Svc B        Svc C
    |               |               |             |
    |-- token ------&gt;|               |             |
    |  (chain=[A])   |               |             |
    |               |-- issued tok -&gt;|             |
    |               |  (chain=[A])   |             |
    |               |               |             |
    |               |&lt;- exchange req-|             |
    |               |  subj_tok:     |             |
    |               |   chain=[A]    |             |
    |               |  actor_tok=B   |             |
    |               |               |             |
    |               |-- issued tok -&gt;|             |
    |               |  (chain=[A,B]) |             |
    |               |               |             |
    |               |               |-- request -&gt;|
    |               |               | token has   |
    |               |               | chain=[A,B] |
</pre><a href="#section-4.4.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="data-plane-policy-enforcement">
<section id="section-4.5">
        <h3 id="name-data-plane-policy-enforceme">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-data-plane-policy-enforceme" class="section-name selfRef">Data-Plane Policy Enforcement</a>
        </h3>
<p id="section-4.5-1">Unlike the nested <code>act</code> claim in [[RFC8693]], the <code>actor_chain</code> claim is explicitly designed to be used in access control decisions. Resource Servers and data-plane proxies MAY apply authorization policies based on any entry in the actor chain.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div id="policy-examples">
<section id="section-4.5.1">
          <h4 id="name-policy-examples">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-policy-examples" class="section-name selfRef">Policy Examples</a>
          </h4>
<p id="section-4.5.1-1">The following are illustrative examples of policies that become expressible with the <code>actor_chain</code> claim:<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2"><strong>Origin-Based Policy</strong>: Allow access only if the originating actor (index 0) is a trusted orchestrator:<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-3">
<pre>actor_chain[0].sub == "https://orchestrator.example.com"
</pre><a href="#section-4.5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-4"><strong>Domain Restriction</strong>: Deny access if any actor in the chain belongs to an untrusted domain:<a href="#section-4.5.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-5">
<pre>for_all(entry in actor_chain):
  entry.iss in ["https://auth.example.com",
                 "https://auth.partner.com"]
</pre><a href="#section-4.5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-6"><strong>Chain Depth Limit</strong>: Reject tokens with delegation chains longer than a configured maximum:<a href="#section-4.5.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-7">
<pre>len(actor_chain) &lt;= 5
</pre><a href="#section-4.5.1-7" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-8"><strong>Residency Requirement</strong>: Require that all actors in the chain have a valid Proof of Residency:<a href="#section-4.5.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-9">
<pre>for_all(entry in actor_chain):
  entry.por is present AND entry.por is valid
</pre><a href="#section-4.5.1-9" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-10"><strong>Path-Based Policy</strong>: Allow access only through a specific delegation path:<a href="#section-4.5.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5.1-11">
<pre>actor_chain[0].sub == "https://orchestrator.example.com" AND
actor_chain[1].sub == "https://planner.example.com"
</pre><a href="#section-4.5.1-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="integration-with-data-plane-proxies">
<section id="section-4.5.2">
          <h4 id="name-integration-with-data-plane">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-integration-with-data-plane" class="section-name selfRef">Integration with Data-Plane Proxies</a>
          </h4>
<p id="section-4.5.2-1">The flat array structure of <code>actor_chain</code> is designed for efficient processing by data-plane proxies such as Envoy, Istio sidecars, and API gateways. Proxies can:<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.5.2-2">
<li id="section-4.5.2-2.1">Extract the <code>actor_chain</code> array from the JWT payload with a single JSON path expression.<a href="#section-4.5.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.5.2-2.2">Iterate linearly over the entries without recursive descent.<a href="#section-4.5.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.5.2-2.3">Index specific entries by position (e.g., <code>actor_chain[0]</code> for the originator).<a href="#section-4.5.2-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.5.2-2.4">Compute <code>len(actor_chain)</code> for depth-based policies without parsing nested structures.<a href="#section-4.5.2-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-4.5.2-2.5">Emit structured log entries per Actor Chain Entry for distributed tracing and forensic analysis.<a href="#section-4.5.2-2.5" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="chain-integrity-verification">
<section id="section-5">
      <h2 id="name-chain-integrity-verificatio">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-chain-integrity-verificatio" class="section-name selfRef">Chain Integrity Verification</a>
      </h2>
<p id="section-5-1">A Relying Party receiving a token with the <code>actor_chain</code> claim MUST perform the following verification steps:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-2">
<li id="section-5-2.1">
          <p id="section-5-2.1.1"><strong>JWT Signature Verification</strong>: Verify the outer JWT signature per standard JWT processing rules. This is REQUIRED in both modes and provides baseline integrity for the entire token, including the <code>actor_chain</code>.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-5-2.2">
          <p id="section-5-2.2.1"><strong>Structural Validation</strong>: Verify that <code>actor_chain</code> is a JSON array with at least one element. Verify that each element contains the required identity fields (<code>sub</code>, <code>iss</code>, <code>iat</code>).<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-5-2.3">
          <p id="section-5-2.3.1"><strong>Per-Entry Signature Verification</strong> (Self-Attested Mode only). For each entry at index <code>i</code>:<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5-2.3.2.1">
              <strong>Compute expected digest</strong>: If <code>i == 0</code>, compute <code>expected_digest = SHA-256(canonical_json({sub, iss, iat}))</code> from the entry's own identity claims. If <code>i &gt; 0</code>, compute <code>expected_digest = SHA-256(canonical_json(actor_chain[0..i-1]))</code>.<a href="#section-5-2.3.2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5-2.3.2.2">
              <strong>Verify chain_digest</strong>: Confirm that the entry's <code>chain_digest</code> matches <code>expected_digest</code>.<a href="#section-5-2.3.2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5-2.3.2.3">
              <strong>Verify chain_sig</strong>: Verify <code>chain_sig</code> against <code>chain_digest</code> using the actor's public key.<a href="#section-5-2.3.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-5-2.4">
          <p id="section-5-2.4.1"><strong>PoR Verification</strong> (if present):<a href="#section-5-2.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5-2.4.2.1">Verify each PoR assertion according to [[!I-D.draft-mw-spice-transitive-attestation]].<a href="#section-5-2.4.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-5-2.5">
          <p id="section-5-2.5.1"><strong>Policy Evaluation</strong>:<a href="#section-5-2.5.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5-2.5.2.1">Apply local authorization policy against the verified actor chain.<a href="#section-5-2.5.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ol>
<p id="section-5-3">If any verification step fails, the Relying Party MUST reject the token.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relation-to-other-ietf-work">
<section id="section-6">
      <h2 id="name-relation-to-other-ietf-work">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-relation-to-other-ietf-work" class="section-name selfRef">Relation to Other IETF Work</a>
      </h2>
<p id="section-6-1">This proposal extends and complements several ongoing efforts:<a href="#section-6-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Specification</th>
            <th class="text-left" rowspan="1" colspan="1">Relationship</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>RFC 8693</strong> [[RFC8693]]</td>
            <td class="text-left" rowspan="1" colspan="1">This document extends [[RFC8693]] by defining <code>actor_chain</code> as a replacement for the informational-only nested <code>act</code> claim. The <code>actor_chain</code> claim is backward-compatible: an AS MAY populate both <code>act</code> (for legacy consumers) and <code>actor_chain</code> (for chain-aware consumers).</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Transitive Attestation</strong> [[!I-D.draft-mw-spice-transitive-attestation]]</td>
            <td class="text-left" rowspan="1" colspan="1">Provides the "North-South" residency proof (agent to local WIA) that complements the "East-West" delegation proof (agent to actor-chain) provided by this document.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>SPICE Architecture</strong> [[!I-D.ietf-spice-arch]]</td>
            <td class="text-left" rowspan="1" colspan="1">Defines the overarching workload identity architecture within which this extension operates.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>WIMSE Architecture</strong> [[!I-D.ietf-wimse-arch]]</td>
            <td class="text-left" rowspan="1" colspan="1">This proposal aligns with the WIMSE delegation and impersonation patterns for distributed microservices architectures.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Attestation-Based Auth</strong> [[!I-D.ietf-oauth-attestation-based-client-auth]]</td>
            <td class="text-left" rowspan="1" colspan="1">Provides the client-to-AS attestation mechanism that can be leveraged to populate the hardware-rooted <code>por</code> claims in Actor Chain Entries.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>SCITT</strong> [[!I-D.ietf-scitt-architecture]]</td>
            <td class="text-left" rowspan="1" colspan="1">Verifiable actor chains can be recorded in SCITT transparency logs to provide long-term, tamper-proof auditability of delegation paths.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>RATS</strong> [[RFC9334]]</td>
            <td class="text-left" rowspan="1" colspan="1">Provides the attestation foundation for PoR assertions embedded in Actor Chain Entries.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>DPoP</strong> [[RFC9449]]</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>actor_chain</code> complements DPoP by providing delegation-chain context alongside proof-of-possession.</td>
          </tr>
        </tbody>
      </table>
<div id="east-west-vs-north-south-security">
<section id="section-6.1">
        <h3 id="name-east-west-vs-north-south-se">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-east-west-vs-north-south-se" class="section-name selfRef">East-West vs. North-South Security</a>
        </h3>
<p id="section-6.1-1">This specification addresses the <strong>East-West</strong> axis of agent-to-agent communication, providing a cryptographically verifiable trail of identity delegation across a network of services. In contrast, Transitive Attestation [[!I-D.draft-mw-spice-transitive-attestation]] addresses the <strong>North-South</strong> axis of an agent's relationship with its local hosting environment (e.g., a Workload Identity Agent on a TEE-enabled node).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">By embedding "North-South" Proofs of Residency (PoR) within "East-West" Actor Chain Entries, a Relying Party gains end-to-end assurance that every entity in a global delegation chain is both a recognized identity and is executing within a verified, secure environment.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="backward-compatibility-with-rfc-8693">
<section id="section-6.2">
        <h3 id="name-backward-compatibility-with">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-backward-compatibility-with" class="section-name selfRef">Backward Compatibility with RFC 8693</a>
        </h3>
<p id="section-6.2-1">An Authorization Server implementing this extension SHOULD populate both the <code>act</code> claim (per [[RFC8693]] Section 4.1) and the <code>actor_chain</code> claim in issued tokens. This ensures that:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.2-2.1">
            <strong>Legacy consumers</strong> that understand only <code>act</code> continue to function correctly, seeing the current actor in the top-level <code>act</code> claim.<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-6.2-2.2">
            <strong>Chain-aware consumers</strong> can use <code>actor_chain</code> for fine-grained policy enforcement and audit.<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-3">The <code>act</code> claim, when present alongside <code>actor_chain</code>, MUST identify the same entity as the last entry in the <code>actor_chain</code> array.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="token-signature-vs-per-entry-chain-signatures">
<section id="section-7.1">
        <h3 id="name-token-signature-vs-per-entr">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-token-signature-vs-per-entr" class="section-name selfRef">Token Signature vs. Per-Entry Chain Signatures</a>
        </h3>
<p id="section-7.1-1">A natural question arises: since the JWT containing the <code>actor_chain</code> is already signed by the Authorization Server (AS), is per-entry <code>chain_sig</code> redundant?<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The answer depends on what each signature proves and when it is produced:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-7.1-3.1">The <strong>JWT outer signature</strong> is produced by the AS when the final token is issued. It proves that the AS issued this specific token with this specific payload. It covers the entire token: <code>sub</code>, <code>aud</code>, <code>exp</code>, <code>actor_chain</code>, and all other claims.<a href="#section-7.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-7.1-3.2">Each <strong><code>chain_sig</code></strong> is produced by an individual actor during token exchange, before the final token exists (see Section "When Chain Signatures Are Produced"). It covers only the <code>chain_digest</code>—the hash of the actor chain state at that actor's point of participation. It proves that this specific actor participated in this specific chain.<a href="#section-7.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.1-4">The JWT outer signature does NOT prove that each individual actor actually participated in the delegation. A compromised or malicious AS could construct any chain it desires. The two modes address different trust assumptions:<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-5.1">
            <p id="section-7.1-5.1.1"><strong>AS-Attested Mode</strong> is appropriate when all participants trust the AS to faithfully record the chain. The AS validates each actor at exchange time, and its JWT signature provides integrity. This is the common single-organization deployment where the AS is a trusted internal service (e.g., a corporate identity provider). Per-actor signatures are omitted, keeping token sizes smaller and reducing cryptographic overhead.<a href="#section-7.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-5.2">
            <p id="section-7.1-5.2.1"><strong>Self-Attested Mode</strong> is appropriate when the chain crosses trust boundaries or when stronger guarantees are needed:<a href="#section-7.1-5.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="section-7.1-5.2.2.1">
                <strong>Federated/Multi-AS environments</strong>: The token may be issued by AS-1 but consumed by a Relying Party that trusts AS-2. Per-actor signatures allow the RP to verify actor participation independently of the issuing AS.<a href="#section-7.1-5.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-7.1-5.2.2.2">
                <strong>Non-repudiation</strong>: Each actor's signature provides cryptographic evidence that it participated in the chain—evidence that the actor cannot deny and that the AS cannot fabricate.<a href="#section-7.1-5.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-7.1-5.2.2.3">
                <strong>Zero-trust posture</strong>: In adversarial environments, the Relying Party may not fully trust any single AS. Per-actor signatures provide defense-in-depth.<a href="#section-7.1-5.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="section-7.1-5.2.2.4">
                <strong>Forensic analysis</strong>: Post-breach investigations can verify the chain using each actor's public key, independent of the AS's continued availability or trustworthiness.<a href="#section-7.1-5.2.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-7.1-6">Deployments SHOULD select the mode that matches their trust model. An AS MAY enforce a specific mode via policy.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chain-integrity">
<section id="section-7.2">
        <h3 id="name-chain-integrity">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-chain-integrity" class="section-name selfRef">Chain Integrity</a>
        </h3>
<p id="section-7.2-1">In AS-Attested Mode, chain integrity is provided by the JWT outer signature. The Relying Party trusts the AS to have correctly constructed the chain.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">In Self-Attested Mode, the hash-chain structure provides additional tamper evidence. Insertion, deletion, or reordering of entries invalidates the <code>chain_digest</code> and <code>chain_sig</code> fields of all subsequent entries. An attacker who compromises a single actor in the chain cannot retroactively alter the entries of prior actors without possessing their signing keys.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay-protection">
<section id="section-7.3">
        <h3 id="name-replay-protection">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-replay-protection" class="section-name selfRef">Replay Protection</a>
        </h3>
<p id="section-7.3-1">Each Actor Chain Entry includes an <code>iat</code> (issued-at) timestamp. Relying Parties SHOULD enforce a maximum age on Actor Chain Entries to prevent replay of stale chains. Additionally, the standard JWT claims <code>exp</code> and <code>nbf</code> on the enclosing token provide overall token-level freshness.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="chain-depth-limits">
<section id="section-7.4">
        <h3 id="name-chain-depth-limits">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-chain-depth-limits" class="section-name selfRef">Chain Depth Limits</a>
        </h3>
<p id="section-7.4-1">Unbounded actor chains pose a risk of token size explosion and processing overhead. Authorization Servers SHOULD enforce a configurable maximum chain depth (<code>max_chain_depth</code>). A RECOMMENDED default maximum is 10 entries. Relying Parties MAY independently enforce their own chain depth limits.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-management">
<section id="section-7.5">
        <h3 id="name-key-management">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-key-management" class="section-name selfRef">Key Management</a>
        </h3>
<p id="section-7.5-1">Each actor in the chain signs its entry with its own key. The security of the entire chain depends on the security of each actor's key material. Actors SHOULD use short-lived keys and/or hardware-protected keys (e.g., via the PoR mechanism). The use of PoR in Actor Chain Entries provides additional assurance that the signing key is bound to a verified execution environment.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-of-prior-actors">
<section id="section-7.6">
        <h3 id="name-privacy-of-prior-actors">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-privacy-of-prior-actors" class="section-name selfRef">Privacy of Prior Actors</a>
        </h3>
<p id="section-7.6-1">The <code>actor_chain</code> expose the identities of all actors in the delegation path to every Relying Party that receives the token. While this is necessary for certain audit and policy requirements, it may conflict with privacy goals. For example, in a chain <code>a -&gt; b -&gt; c -&gt; d -&gt; e</code>, the originating actor <code>a</code> may require its identity to be hidden from <code>e</code> while still ensuring the integrity of the delegation.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">Deployments SHOULD consider the following anonymization and privacy-preserving techniques:<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<div id="pseudonymous-identifiers">
<section id="section-7.6.1">
          <h4 id="name-pseudonymous-identifiers">
<a href="#section-7.6.1" class="section-number selfRef">7.6.1. </a><a href="#name-pseudonymous-identifiers" class="section-name selfRef">Pseudonymous Identifiers</a>
          </h4>
<p id="section-7.6.1-1">Instead of using globally unique or stable identifiers (like email addresses or client IDs), the Authorization Server (AS) can issue pairwise pseudonyms for actors. In the chain <code>a -&gt; b -&gt; c -&gt; d -&gt; e</code>:
- The AS replaces <code>sub: "a"</code> with a pseudonym <code>sub: "pseudo-xyz"</code> that is only meaningful to the AS.
- Relying Party <code>e</code> sees that the chain started with a verified actor, but does not know it was <code>a</code>.
- The AS maintains a mapping to allow for forensic reconstruction if authorized.<a href="#section-7.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="selective-disclosure-sd-jwt-1">
<section id="section-7.6.2">
          <h4 id="name-selective-disclosure-sd-jwt-2">
<a href="#section-7.6.2" class="section-number selfRef">7.6.2. </a><a href="#name-selective-disclosure-sd-jwt-2" class="section-name selfRef">Selective Disclosure (SD-JWT)</a>
          </h4>
<p id="section-7.6.2-1">The <code>actor_chain</code> MAY be implemented using Selective Disclosure for JWTs [[!I-D.ietf-oauth-selective-disclosure-jwt]]. This allows individual Actor Chain Entries to be hashed with unique salts, enabling verification of the entry's integrity without revealing its cleartext content unless a corresponding disclosure is provided.<a href="#section-7.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identity-bridging-for-anonymity">
<section id="section-7.6.3">
          <h4 id="name-identity-bridging-for-anony">
<a href="#section-7.6.3" class="section-number selfRef">7.6.3. </a><a href="#name-identity-bridging-for-anony" class="section-name selfRef">Identity Bridging for Anonymity</a>
          </h4>
<p id="section-7.6.3-1">An Identity Bridge [[!I-D.ietf-spice-arch]] MAY act as an "Anonymizer" by performing a token exchange that replaces sensitive predecessor entries in the <code>actor_chain</code> with generic or pseudonymous identifiers, while still vouching for the chain's security properties.<a href="#section-7.6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="targeted-selective-disclosure">
<section id="section-7.6.4">
          <h4 id="name-targeted-selective-disclosu">
<a href="#section-7.6.4" class="section-number selfRef">7.6.4. </a><a href="#name-targeted-selective-disclosu" class="section-name selfRef">Targeted Selective Disclosure</a>
          </h4>
<p id="section-7.6.4-1">A more advanced privacy model involves disclosing actor identities only to trusted intermediate parties. In the chain <code>a -&gt; b -&gt; c -&gt; d -&gt; e</code>, actor <code>a</code> may be visible to <code>b</code>, <code>c</code>, and <code>d</code>, but hidden from <code>e</code>.<a href="#section-7.6.4-1" class="pilcrow">¶</a></p>
<p id="section-7.6.4-2">This is achieved through <strong>Targeted Disclosure</strong> using SD-JWT:
- The AS generates the <code>actor_chain</code> with actor <code>a</code>'s identity hashed and salted.
- Alongside the JWT, the AS provides a "Disclosure" string (the salt and cleartext value) for actor <code>a</code>.
- When the AS issues a token for <code>b</code>, <code>c</code>, or <code>d</code>, it includes this disclosure string. This allows these "internal" actors to "unlock" the hash and see <code>a</code>'s true identity.
- When the final token is exchanged for recipient <code>e</code>, the AS (or the last internal actor <code>d</code>) simply omits the disclosure string for actor <code>a</code>.
- Actor <code>e</code> receives the same JWT but without the "key" to unlock <code>a</code>. <code>e</code> can verify the cryptographic integrity of the entire chain (proving that a verified, though anonymous, actor started it) without ever seeing <code>a</code>'s identity.<a href="#section-7.6.4-2" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Recipient</th>
                <th class="text-left" rowspan="1" colspan="1">JWT Payload</th>
                <th class="text-left" rowspan="1" colspan="1">Disclosure provided?</th>
                <th class="text-left" rowspan="1" colspan="1">Interpretation</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Actor b</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>_sd: [hash_a]</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Yes</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>b</code> sees <code>sub: a</code>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Actor e</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>_sd: [hash_a]</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>No</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>e</code> sees <code>sub: &lt;hidden&gt;</code>
</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="encryption-jwe">
<section id="section-7.6.5">
          <h4 id="name-encryption-jwe">
<a href="#section-7.6.5" class="section-number selfRef">7.6.5. </a><a href="#name-encryption-jwe" class="section-name selfRef">Encryption (JWE)</a>
          </h4>
<p id="section-7.6.5-1">The entire <code>actor_chain</code> claim can be encrypted using JWE [[RFC7516]] so that only the final intended audience <code>e</code> can decrypt it, preventing intermediate actors like <code>b</code>, <code>c</code>, and <code>d</code> from seeing the IDs of their predecessors. Alternatively, the chain can be nestedly encrypted for different parties in the path.<a href="#section-7.6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="confused-deputy-mitigation">
<section id="section-7.7">
        <h3 id="name-confused-deputy-mitigation">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-confused-deputy-mitigation" class="section-name selfRef">Confused Deputy Mitigation</a>
        </h3>
<p id="section-7.7-1">In both modes, a confused deputy attack—where a legitimate actor is tricked into delegating to a malicious downstream—is detectable because the malicious downstream actor's identity appears in the chain, providing forensic evidence of the attack path. In Self-Attested Mode, the malicious actor's own cryptographic signature provides non-repudiable evidence of its participation.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="json-web-token-claims-registration">
<section id="section-8.1">
        <h3 id="name-json-web-token-claims-regis">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-json-web-token-claims-regis" class="section-name selfRef">JSON Web Token Claims Registration</a>
        </h3>
<p id="section-8.1-1">This document requests registration of the following claim in the "JSON Web Token Claims" registry established by [[RFC7519]]:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1-2.1">
            <strong>Claim Name</strong>: <code>actor_chain</code><a href="#section-8.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.1-2.2">
            <strong>Claim Description</strong>: A Cryptographically Verifiable Actor Chain — an ordered array of actor entries representing the complete delegation chain with optional per-entry cryptographic signatures.<a href="#section-8.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.1-2.3">
            <strong>Change Controller</strong>: IETF<a href="#section-8.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.1-2.4">
            <strong>Specification Document(s)</strong>: [this document]<a href="#section-8.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="cbor-web-token-claims-registration">
<section id="section-8.2">
        <h3 id="name-cbor-web-token-claims-regis">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-cbor-web-token-claims-regis" class="section-name selfRef">CBOR Web Token Claims Registration</a>
        </h3>
<p id="section-8.2-1">This document requests registration of the following claim in the "CBOR Web Token (CWT) Claims" registry established by [[RFC8392]]:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.2-2.1">
            <strong>Claim Name</strong>: <code>actor_chain</code><a href="#section-8.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-2.2">
            <strong>Claim Description</strong>: A Cryptographically Verifiable Actor Chain.<a href="#section-8.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-2.3">
            <strong>CBOR Key</strong>: TBD (e.g., 40)<a href="#section-8.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-2.4">
            <strong>Claim Type</strong>: array<a href="#section-8.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-2.5">
            <strong>Change Controller</strong>: IETF<a href="#section-8.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-2.6">
            <strong>Specification Document(s)</strong>: [this document]<a href="#section-8.2-2.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">A Prasad</span></div>
<div dir="auto" class="left"><span class="org">Oracle</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:a.prasad@oracle.com" class="email">a.prasad@oracle.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ram Krishnan</span></div>
<div dir="auto" class="left"><span class="org">JPMorgan Chase &amp; Co</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ramkri123@gmail.com" class="email">ramkri123@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Diego R. Lopez</span></div>
<div dir="auto" class="left"><span class="org">Telefonica</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:diego.r.lopez@telefonica.com" class="email">diego.r.lopez@telefonica.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Srinivasa Addepalli</span></div>
<div dir="auto" class="left"><span class="org">Aryaka</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:srinivasa.addepalli@aryaka.com" class="email">srinivasa.addepalli@aryaka.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
